(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"11":function(t,e,i){"use strict";i.r(e);var a=i(0),n=i(105),s=i(1),r=i(6),o=i(108),l=i(115),c=(i(99),i(107)),h=i(112),p=i(117),u=i(111),f=i(109),m=(i(26),i(114)),d=i(102),g=i(18),y=i(29),v=i(22),b=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function sliceIterator(t,e){var i=[],a=!0,n=!1,s=void 0;try{for(var r,o=t[Symbol.iterator]();!(a=(r=o.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){n=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw s}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),C=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}();var w=function(t){function ACItem(){!function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ACItem);var t=function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(ACItem.__proto__||Object.getPrototypeOf(ACItem)).apply(this,arguments));return t.rendered=!1,t.item=new v.e("","",[],-1,-1),t.variations=[],t.materials=new Array,t.showVariationPanel=!1,t}return function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(ACItem,s["a"].Component),C(ACItem,[{"key":"init","value":function init(t){var e=this;this.item=v.d.dict[t.ID];var i=new Array;"variations"in this.item&&0!=this.item.variations.length?i=this.item.variations:i.push(this.item.ID);var a=v.a.get(this.item.ID);this.variations=i.map(function(t){return{"ID":t,"text":g.a.get(t),"thumb":"","status":a.includes(t)?2:0}}),y.a.init(this.item.parent(v.d.Level.C)).then(function(){e.variations.forEach(function(t){t.thumb=y.a.get(t.ID)}),e.rendered&&e.forceUpdate()}),this.init_materials()}},{"key":"init_materials","value":function init_materials(){"recipe"in this.item.details&&(this.materials=this.item.details.recipe.materials.map(function(t){var e=v.d.dict[t[1]],i="variations"in e&&e.variations.length>0?e.variations[0]:t[1];return[t[0],t[1],i]}),this.materials.forEach(function(t){var e=b(t,2),i=(e[0],e[1]);y.a.init(v.d.dict[i].parent(v.d.Level.C))}))}},{"key":"componentWillMount","value":function componentWillMount(){this.init(this.props)}},{"key":"shouldComponentUpdate","value":function shouldComponentUpdate(t,e){return t.ID!=this.props.ID?(this.rendered=!1,this.init(t),!0):t.span!=this.props.span}},{"key":"componentDidMount","value":function componentDidMount(){this.rendered=!0}},{"key":"componentDidUpdate","value":function componentDidUpdate(){this.rendered=!0}},{"key":"render","value":function render(){var t=this;return this.rendered=!0,a.j.createElement(o.a,{"className":"ac-item-"+(12==this.props.span?"s":"m"),"onClick":this.onClick.bind(this)},this.showVariationPanel&&a.j.createElement(m.a,{"isOpened":!0,"onClose":this.closeVariationPanel.bind(this)},a.j.createElement(d.a,null,a.j.createElement(o.a,{"className":"ac-text-m ac-align-c"},g.a.get("s-vari")),this.variations.map(function(e){return a.j.createElement(o.a,{"className":"at-row ac-variation-box"},a.j.createElement(u.a,{"src":e.thumb,"style":"width:32px;height:32px;"}),a.j.createElement(f.a,{"style":"line-height:40px;"},e.text),a.j.createElement(h.a,{"className":"ac-item-icon","color":["#AAAAAA","#AAAAAA","#FF3300"][e.status],"value":"star"+(e.status>0?"-2":""),"onClick":function(){t.variationButtonClick(e.ID)}.bind(t)}))}),this.materials.length>0&&a.j.createElement(o.a,{"className":"ac-text-m ac-align-c"},g.a.get("c-mate")),this.materials.map(function(t){return a.j.createElement(o.a,{"className":"at-row ac-variation-box"},a.j.createElement(u.a,{"src":y.a.get(t[2]),"style":"width:32px;height:32px;"}),a.j.createElement(f.a,{"style":"line-height:40px;"},g.a.get(t[1])),a.j.createElement(f.a,{"className":"ac-align-c","style":"min-width:32px;line-height:40px;"},String(t[0])))}))),a.j.createElement(u.a,{"src":this.variations[0].thumb,"className":"ac-thumb-"+(12==this.props.span?"s":"m")}),a.j.createElement(f.a,{"className":"ac-limited-text ac-item-title-"+(12==this.props.span?"s":"m"),"style":"width: calc(100% - "+(12==this.props.span?"160":"0")+"px);"},g.a.get(this.item.ID)),12==this.props.span&&this.item.sources.map(function(e){var i=[24,16][t.item.sources.length-1],n=[4,8][t.item.sources.length-1];return a.j.createElement(u.a,{"src":y.a.get(e),"className":"ac-float-r","style":"width:"+i+"px;height:"+i+"px;padding:"+n+"px 0;"})}),12==this.props.span&&-1!=this.item.buy&&a.j.createElement(f.a,{"className":"ac-limited-text ac-text-1 ac-float-r ac-align-r ac-text-m","style":"max-width:50px;padding:0px 2px;"},this.item.buy),12==this.props.span&&a.j.createElement(o.a,{"className":"ac-float-l","style":"width:200px;height:28px;overflow:hidden;"},this.variations.slice(1).map(function(t){return a.j.createElement(u.a,{"src":t.thumb,"className":"ac-float-l","style":"width:24px;height:24px;padding:2px 1px;"})})),12==this.props.span&&a.j.createElement(h.a,{"className":"ac-item-icon ac-float-r","color":["#AAAAAA","#AAAAAA","#FF3300"][this.status],"value":"star"+(this.status>0?"-2":""),"onClick":this.favoriteButtonClick.bind(this)}))}},{"key":"onClick","value":function onClick(){12==this.props.span&&0==this.materials.length||(this.showVariationPanel=!0,this.forceUpdate())}},{"key":"toggleStatus","value":function toggleStatus(t){2==t.status?(v.a.remove(t.ID),t.status=0):(v.a.add(t.ID),t.status=2),this.forceUpdate()}},{"key":"favoriteButtonClick","value":function favoriteButtonClick(){if(this.variations.length>1)return this.showVariationPanel=!0,void this.forceUpdate();this.toggleStatus(this.variations[0])}},{"key":"variationButtonClick","value":function variationButtonClick(t){this.toggleStatus(this.variations.find(function(e){return e.ID==t}))}},{"key":"closeVariationPanel","value":function closeVariationPanel(){this.showVariationPanel=!1,this.forceUpdate()}},{"key":"status","get":function get(){var t=this.variations.filter(function(t){return 2==t.status}).length;return t==this.variations.length?2:this.variations.length>1&&t>0?1:0}}]),ACItem}();w.options={"addGlobalClass":!0};var j=i(28),x=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}();var A=function(t){function ACVillagerInfo(t){return function vinfo_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ACVillagerInfo),function vinfo_possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(ACVillagerInfo.__proto__||Object.getPrototypeOf(ACVillagerInfo)).call(this,t))}return function vinfo_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(ACVillagerInfo,s["a"].Component),x(ACVillagerInfo,[{"key":"render","value":function render(){if(void 0==this.props.villager)return a.j.createElement(o.a,null);var t=g.a.get(this.props.villager.parent(v.d.Level.P)).split("·"),e=1==t.length?t[0]:t[this.props.villager.gender];return a.j.createElement(o.a,null,a.j.createElement(f.a,{"className":"ac-float-l ac-align-c","style":"width:100%;font-size:20px;padding:0 0 10px 0;"},g.a.get(this.props.villager.ID)),a.j.createElement(u.a,{"className":"ac-float-l","style":"width:128px;height:128px;","src":j.b+"/compress/c-vill/photo/"+this.props.villager.ID+".png"}),a.j.createElement(f.a,{"className":"ac-float-r ac-align-c ac-limited-text ac-text-m","style":"width:calc(100% - 130px);line-height:43px;"},["♀","♂"][this.props.villager.gender]+" "+e),a.j.createElement(f.a,{"className":"ac-float-r ac-align-c ac-limited-text ac-text-m","style":"width:calc(100% - 130px);line-height:43px;"},g.a.get("s-mt."+this.props.villager.birthady[0])+" "+this.props.villager.birthady[1]+g.a.get("s-dysf")),a.j.createElement(f.a,{"className":"ac-float-r ac-align-c ac-limited-text ac-text-m","style":"width:calc(100% - 130px);line-height:43px;"},g.a.get(this.props.villager.personality)),a.j.createElement(u.a,{"className":"ac-float-l ac-villager-poster","src":j.b+"/compress/c-vill/poster/"+this.props.villager.ID+".jpg"}),a.j.createElement(u.a,{"className":"ac-float-r ac-villager-exterior","src":j.b+"/compress/c-vill/exterior/"+this.props.villager.ID+".png"}))}}]),ACVillagerInfo}();A.options={"addGlobalClass":!0};var k=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}();var E=function(t){function ACVillager(){!function villager_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ACVillager);var t=function villager_possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(ACVillager.__proto__||Object.getPrototypeOf(ACVillager)).apply(this,arguments));return t.rendered=!1,t.thumb="",t.villager=new v.f("","",0,"",[1,1]),t.info="",t.birthday="",t.showInfoPanel=!1,t}return function villager_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(ACVillager,s["a"].Component),k(ACVillager,[{"key":"init","value":function init(t){var e=this;this.villager=v.d.dict[t.ID],this.birthday=g.a.get("s-mt."+this.villager.birthady[0])+" "+this.villager.birthady[1]+g.a.get("s-dysf"),this.info=["♀","♂"][this.villager.gender]+" "+g.a.get(this.villager.personality),this.status=Number(v.a.get(this.villager.ID).includes(this.villager.ID)),y.a.init("villagers").then(function(){e.thumb=y.a.get(t.ID),e.rendered&&e.forceUpdate()})}},{"key":"componentWillMount","value":function componentWillMount(){this.init(this.props)}},{"key":"shouldComponentUpdate","value":function shouldComponentUpdate(t,e){return t.ID!=this.props.ID?(this.rendered=!1,this.init(t),!0):t.span!=this.props.span}},{"key":"render","value":function render(){return this.rendered=!0,a.j.createElement(o.a,{"className":"ac-item-"+(12==this.props.span?"s":"m"),"onClick":this.onClick.bind(this)},a.j.createElement(m.a,{"isOpened":this.showInfoPanel,"onClose":this.closeInfoPanel.bind(this)},this.showInfoPanel&&a.j.createElement(d.a,null,a.j.createElement(A,{"villager":this.villager}))),a.j.createElement(u.a,{"src":this.thumb,"className":"ac-thumb-"+(12==this.props.span?"s":"m")}),a.j.createElement(f.a,{"className":"ac-limited-text ac-villager-title-"+(12==this.props.span?"s":"m"),"style":"width: calc(100% - "+(12==this.props.span?"170":"0")+"px);"},g.a.get(this.villager.ID)),12==this.props.span&&a.j.createElement(f.a,{"className":"ac-limited-text ac-text-1 ac-float-r ac-align-r","style":"width:90px;font-size:18px;"},this.birthday),12==this.props.span&&a.j.createElement(f.a,{"className":"ac-limited-text ac-text-2 ac-float-l ac-align-l"},this.info),12==this.props.span&&a.j.createElement(h.a,{"className":"ac-item-icon ac-float-r","color":["#AAAAAA","#FF3300"][this.status],"value":"heart"+(this.status>0?"-2":""),"onClick":this.toggleStatus.bind(this)}))}},{"key":"toggleStatus","value":function toggleStatus(){v.a.get(this.villager.ID).includes(this.villager.ID)?(v.a.remove(this.villager.ID),this.status=0):(v.a.add(this.villager.ID),this.status=1),this.forceUpdate()}},{"key":"onClick","value":function onClick(){this.showInfoPanel=!0,this.forceUpdate()}},{"key":"closeInfoPanel","value":function closeInfoPanel(){this.showInfoPanel=!1,this.forceUpdate()}}]),ACVillager}();E.options={"addGlobalClass":!0};var I=i(34);i.d(e,"default",function(){return P});var _=function(){function defineProperties(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,i){return e&&defineProperties(t.prototype,e),i&&defineProperties(t,i),t}}(),O=function get(t,e,i){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,e);if(void 0===a){var n=Object.getPrototypeOf(t);return null===n?void 0:get(n,e,i)}if("value"in a)return a.value;var s=a.get;return void 0!==s?s.call(i):void 0};var P=function(t){function ACList(t){!function list_classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ACList);var e=function list_possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(ACList.__proto__||Object.getPrototypeOf(ACList)).call(this,t));e.primaryFilters=[{"text":"","value":""}],e.secondaryFilters=[[{"text":"","value":""}]],e.sorters=[];var i=Object(n.a)();return e.maxGrids=Math.floor(i.windowWidth/100),e.firstItems=e.maxGrids*Math.ceil(i.windowHeight/84),e.state.span=12,e.state.items=new Array,e.state.showSearchBar=!1,e.state.filters=[0,0],e.state.sorter=0,e.state.tag=!1,e}return function list_inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{"constructor":{"value":t,"enumerable":!1,"writable":!0,"configurable":!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(ACList,s["a"].Component),_(ACList,[{"key":"init","value":function init(){if(this.listOption=v.b.get(this.$router.params),void 0==this.listOption)return console.log(this.$router.params),void s.a.navigateTo({"url":"../index/index"});this.type=this.listOption.type,this.list=v.d.dict[this.listOption.ID].flatten(v.d.Level.G),this.sorters=this.listOption.sorters.map(function(t){return t.ID}),this.initFilters(),this.items=this.list,this.sorters=this.sorters.map(function(t){return g.a.get(t)}),this.primaryFilters.forEach(function(t){t.text=g.a.get(t.text)}),this.secondaryFilters.forEach(function(t){return t.forEach(function(t){t.text=g.a.get(t.text)})}),this.sort(),this.forceUpdate()}},{"key":"componentWillMount","value":function componentWillMount(){console.log(this.$router.params),g.a.init("main").then(this.init.bind(this))}},{"key":"render","value":function render(){var t=this;return a.j.createElement(o.a,null,a.j.createElement(o.a,{"className":"ac-top-bar"},a.j.createElement(I.a,null),a.j.createElement(c.a,{"className":"ac-fab ac-fab-2"},a.j.createElement(h.a,{"value":12==this.state.span?"loading-2":"list","onClick":this.gridIconClick.bind(this)})),a.j.createElement(h.a,{"className":"ac-top-icon","value":this.state.showSearchBar?"filter":"search","onClick":this.searchIconClick.bind(this)}),this.state.showSearchBar&&a.j.createElement(p.a,{"placeholder":"key words","name":"","value":this.state.searchText,"onConfirm":this.search.bind(this),"onChange":this.changeSearch.bind(this)}),!this.state.showSearchBar&&a.j.createElement(l.a,{"style":"width:33%;","mode":"multiSelector","range":[this.primaryFilters,this.secondaryFilters[this.state.filters[0]]],"rangeKey":"text","value":this.state.filters,"onChange":this.applyFilter.bind(this),"onCancel":this.applyFilter.bind(this),"onColumnChange":this.changeFilter.bind(this)},a.j.createElement(o.a,{"className":"ac-current-text ac-limited-text"},this.primaryFilters[this.state.filters[0]].text)),a.j.createElement(l.a,{"style":"width:25%;","mode":"multiSelector","range":[this.sorters],"value":[this.state.sorter],"onChange":this.applyFilter.bind(this),"onCancel":this.sort.bind(this),"onColumnChange":this.changeSorter.bind(this)},a.j.createElement(o.a,{"className":"ac-current-text ac-limited-text"},this.sorters[this.state.sorter])),a.j.createElement(h.a,{"className":"ac-top-icon","value":("item"==this.type?"star":"heart")+(this.state.tag?"-2":""),"color":this.state.tag?"#FF3300":"#AAAAAA","onClick":this.toggleTag.bind(this)})),a.j.createElement(o.a,{"className":"at-row at-row--wrap","style":"margin-top:40px;"},this.state.items.map(function(e){return a.j.createElement(o.a,{"className":"at-col-"+t.state.span},"item"==t.type&&a.j.createElement(w,{"span":t.state.span,"ID":e}),"villager"==t.type&&a.j.createElement(E,{"span":t.state.span,"ID":e}))})))}},{"key":"initFilters","value":function initFilters(){var t=this,e=new Array,i=function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{"value":i,"enumerable":!0,"configurable":!0,"writable":!0}):t[e]=i,t}({},"s-all",new Array);this.list.children.forEach(function(a){var n=v.d.dict[a],s=t.listOption.primaryFilter(n);s.forEach(function(t){e.includes(t)||(e.push(t),i[t]=new Array)}),t.listOption.secondaryFilter(n).forEach(function(t){s.forEach(function(e){i[e].includes(t)||i[e].push(t)}),i["s-all"].includes(t)||i["s-all"].push(t)})}),(e.length>1||0==e.length)&&e.unshift("s-all"),this.primaryFilters=e.map(function(t){return{"text":t,"value":t}}),this.secondaryFilters=e.map(function(t){var e=i[t];return(e.length>1||0==e.length)&&e.unshift("s-all"),e.map(function(t){return{"text":t,"value":t}})})}},{"key":"changeFilter","value":function changeFilter(t){this.state.filters[t.detail.column]=t.detail.value,0==t.detail.column&&(this.state.filters[1]=0),this.setState({"filters":this.state.filters})}},{"key":"applyFilter","value":function applyFilter(){this.filter()}},{"key":"searchIconClick","value":function searchIconClick(){this.state.showSearchBar?(this.setState({"showSearchBar":!1}),this.filter()):this.setState({"searchText":"","showSearchBar":!0})}},{"key":"changeSearch","value":function changeSearch(t){this.setState({"searchText":t})}},{"key":"gridIconClick","value":function gridIconClick(){this.setState({"span":12==this.state.span?Math.ceil(12/this.maxGrids):12})}},{"key":"changeSorter","value":function changeSorter(t){this.setState({"sorter":t.detail.value})}},{"key":"toggleTag","value":function toggleTag(){this.state.tag=!this.state.tag,this.showFirstItems()}},{"key":"onReachBottom","value":function onReachBottom(){this.addItems(3*this.maxGrids)}},{"key":"filter","value":function filter(){var t=this,e=this.primaryFilters[this.state.filters[0]].value,i=this.secondaryFilters[this.state.filters[0]][this.state.filters[1]].value;this.items=this.list.filter(function(a){return("s-all"==e||t.listOption.primaryFilter(a).includes(e))&&("s-all"==i||t.listOption.secondaryFilter(a).includes(i))}),this.sort()}},{"key":"sort","value":function sort(){this.items.sort(this.listOption.sorters[this.state.sorter].method),this.showFirstItems()}},{"key":"search","value":function search(){""!=this.state.searchText&&(this.items=this.list.search(this.state.searchText),this.sort())}},{"key":"showFirstItems","value":function showFirstItems(){this.state.items=new Array,this.addedItems=0,this.addItems(this.firstItems)}},{"key":"addItems","value":function addItems(t){if(!(this.items.children.length<=this.addedItems)){for(;this.addedItems<this.items.children.length&&t>0;this.addedItems++){var e=this.items.children[this.addedItems];(!this.state.tag||v.a.get(e).length>0)&&(this.state.items.push(e),t--)}this.setState({"items":this.state.items})}}},{"key":"componentDidMount","value":function componentDidMount(){O(ACList.prototype.__proto__||Object.getPrototypeOf(ACList.prototype),"componentDidMount",this)&&O(ACList.prototype.__proto__||Object.getPrototypeOf(ACList.prototype),"componentDidMount",this).call(this)}},{"key":"componentDidShow","value":function componentDidShow(){O(ACList.prototype.__proto__||Object.getPrototypeOf(ACList.prototype),"componentDidShow",this)&&O(ACList.prototype.__proto__||Object.getPrototypeOf(ACList.prototype),"componentDidShow",this).call(this),this._offReachBottom=Object(r.a)({"callback":this.onReachBottom,"ctx":this,"onReachBottomDistance":void 0})}},{"key":"componentDidHide","value":function componentDidHide(){O(ACList.prototype.__proto__||Object.getPrototypeOf(ACList.prototype),"componentDidHide",this)&&O(ACList.prototype.__proto__||Object.getPrototypeOf(ACList.prototype),"componentDidHide",this).call(this),this._offReachBottom&&this._offReachBottom()}}]),ACList}();P.options={"addGlobalClass":!0}},"99":function(t,e,i){}}]);